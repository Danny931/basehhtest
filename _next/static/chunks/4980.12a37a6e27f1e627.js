"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4980],{44980:function(n,r,e){e.r(r),e.d(r,{default:function(){return F}});var t,o,c,i,a=e(70865),s=e(87394),u=e(92228),l=e(52322),d=e(7599),h=e(65957),f=e(3411),b=e(8659),p=e(76903),g=e(13670),k=e(98813),v=e(89495),x=e(11781),m=e(72135),Z=e(98788),N=e(5163),B=e(2784),y=e(6647),j=e(11536),w=e(10494),I=e(68175);function S(){var n=(0,u.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return S=function(){return n},n}(P=t||(t={}))[P.OK=0]="OK",P[P.WARNING=1]="WARNING",P[P.NOT_OK=2]="NOT_OK",P[P.UNKNOWN=3]="UNKNOWN";var O=function(n){var r=(0,B.useState)({status:t.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),e=r[0],o=r[1];return(0,I.X)(function(r){var e;(e=(0,Z.Z)(function(){var e,c,i,a,u,l,d,h,f;return(0,N.__generator)(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,Promise.all([(0,y.request)(w.AM,(0,y.gql)(S(),n)),r?Promise.resolve(r):j.v.getBlockNumber()])];case 1:return c=(e=s.Z.apply(void 0,[b.sent(),2]))[0].indexingStatusForCurrentVersion,i=e[1],a="healthy"===c.health,u=parseInt(c.chains[0].chainHeadBlock.number),d=i-(l=parseInt(c.chains[0].latestBlock.number)),h=i-u,!a||d>200||h>200?o({status:t.NOT_OK,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}):d>50||h>50?o({status:t.WARNING,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}):o({status:t.OK,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}),[3,3];case 2:return f=b.sent(),console.error("Failed to perform health check for ".concat(n," subgraph"),f),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)})()},[n]),e};function C(){var n=(0,u.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return C=function(){return n},n}function D(){var n=(0,u.Z)(["\n  gap: 7px;\n"]);return D=function(){return n},n}function K(){var n=(0,u.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return K=function(){return n},n}var P,_=(0,f.ZP)(b.Z).withConfig({componentId:"sc-46961c6e-0"})(C()),W=(0,f.ZP)(p.Z).withConfig({componentId:"sc-46961c6e-1"})(D()),A=(0,f.ZP)(g.Z).withConfig({componentId:"sc-46961c6e-2"})(K(),function(n){var r=n.$color;return n.theme.colors[r]}),R=function(n){var r=n.color,e=n.label,t=n.description,o=n.currentBlock,c=n.secondRemainingBlockSync,i=n.blockNumberFromSubgraph,a=(0,h.$G)().t;return(0,l.jsxs)(g.Z,{children:[(0,l.jsxs)(W,{pb:"10px",children:[(0,l.jsx)(A,{$color:r}),(0,l.jsx)(v.Z,{children:e})]}),(0,l.jsx)(v.Z,{pb:"24px",children:t}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[a("Chain Head Block"),":"]})," ",o]}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[a("Latest Subgraph Block"),":"]})," ",i]}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[a("Delay"),":"]})," ",o-i," (",c,"s)"]})]})},F=function(n){var r,e,u,f=n.subgraphName,b=n.inline,p=n.customDescriptions,Z=n.obeyGlobalSetting,N=(0,h.$G)().t,B=O(f),y=B.status,j=B.currentBlock,w=B.blockDifference,I=B.latestBlock,S=(0,s.Z)((0,m.YF)(),1)[0],C=y===t.WARNING||y===t.NOT_OK,D={delayed:{label:N("Delayed"),color:"failure",description:null!==(o=null==p?void 0:p.delayed)&&void 0!==o?o:N("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:N("Slight delay"),color:"warning",description:null!==(c=null==p?void 0:p.slow)&&void 0!==c?c:N("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:N("Fast"),color:"success",description:null!==(i=null==p?void 0:p.healthy)&&void 0!==i?i:N("No issues with the subgraph.")}},K=w*d.hJ,P=D[y===t.NOT_OK?"delayed":y===t.WARNING?"slow":"healthy"],F=(0,k.Z)((0,l.jsx)(R,(0,a.Z)({currentBlock:j,secondRemainingBlockSync:K,blockNumberFromSubgraph:I},P)),{placement:"top"}),G=F.targetRef,H=F.tooltipVisible,$=F.tooltip;return I&&j&&((void 0===Z||Z)&&S||C)?b?(0,l.jsxs)(W,{alignItems:"center",justifyContent:"flex-end",ref:G,children:[(0,l.jsx)(A,{$color:P.color}),(0,l.jsx)(v.Z,{children:P.label}),(0,l.jsx)(x.Z,{}),H&&$]}):(0,l.jsxs)(g.Z,{position:"fixed",bottom:"calc(55px + env(safe-area-inset-bottom))",right:"5%",ref:G,"data-test":"subgraph-health-indicator",children:[H&&$,(0,l.jsx)(_,{children:(0,l.jsxs)(W,{alignItems:"center",p:"10px",children:[(0,l.jsx)(A,{$color:P.color}),(0,l.jsx)(v.Z,{children:P.label}),(0,l.jsx)(x.Z,{})]})})]}):null}},68175:function(n,r,e){e.d(r,{X:function(){return l},a:function(){return u}});var t=e(50930),o=e(74086),c=e(2784),i=e(49857),a=e(65342),s=[];function u(n,r){var e=(0,a.Z)().chainId,u=(0,i.ZP)(e&&[o.sR,"blockNumber",e]).data,l=void 0===u?0:u;(0,c.useEffect)(n.bind(null,l),[l].concat((0,t.Z)(r||s)))}function l(n,r){var e=(0,a.Z)().chainId,u=(0,i.ZP)(e&&[o.KI,"blockNumber",e]).data,l=void 0===u?0:u;(0,c.useEffect)(n.bind(null,l),[l].concat((0,t.Z)(r||s)))}},8659:function(n,r,e){e.d(r,{Z:function(){return x}});var t=e(70865),o=e(96670),c=e(26297),i=e(52322);e(2784);var a=e(92228),s=e(3411),u=e(78545),l=e(13670);function d(){var n=(0,a.Z)(["\n  0% {\n    background-position: 50% 0%;\n  }\n  50% {\n    background-position: 50% 100%;\n  }\n  100% {\n    background-position: 50% 0%;\n  }\n"]);return d=function(){return n},n}function h(){var n=(0,a.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return h=function(){return n},n}function f(){var n=(0,a.Z)(["\n  background: ",";\n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return f=function(){return n},n}function b(){var n=(0,a.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: ",";\n"]);return b=function(){return n},n}var p=(0,s.F4)(d()),g=function(n){var r=n.isActive,e=n.isSuccess,t=n.isWarning,o=n.borderBackground,c=n.theme;return o||(t?c.colors.warning:e?c.colors.success:r?"linear-gradient(180deg, ".concat(c.colors.primaryBright,", ").concat(c.colors.secondary,")"):c.colors.cardBorder)},k=s.ZP.div.withConfig({componentId:"sc-eecfaa46-0"})(f(),g,function(n){return n.theme.radii.card},function(n){var r=n.theme,e=n.isDisabled;return r.colors[e?"textDisabled":"text"]},function(n){return n.isActive&&(0,s.iv)(h(),p)},u.Dh),v=(0,s.ZP)(l.Z).withConfig({componentId:"sc-eecfaa46-1"})(b(),function(n){return n.hasCustomBorder?"initial":"inherit"},function(n){var r=n.theme,e=n.background;return null!=e?e:r.card.background},function(n){return n.theme.radii.card});k.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var x=function(n){var r=n.ribbon,e=n.children,a=n.background,s=(0,c.Z)(n,["ribbon","children","background"]);return(0,i.jsx)(k,(0,o.Z)((0,t.Z)({},s),{children:(0,i.jsxs)(v,{background:a,hasCustomBorder:!!s.borderBackground,children:[r,e]})}))}}}]);
//# sourceMappingURL=4980.12a37a6e27f1e627.js.map